
<!DOCTYPE html>
<html>

<head>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>

<div id="container" style="min-width: 310px; height: 700px; margin: 0 auto"></div>



</head>

<body onload="WTCall()">

<script>



function WTCall() {

xmlhttp = new XMLHttpRequest();
var url = "https://bnnq37uk24.execute-api.eu-west-1.amazonaws.com/Prod/custvisits-today";
xmlhttp.open("GET", url, true);
xmlhttp.setRequestHeader("Content-type", "application/json");
xmlhttp.onreadystatechange = function () {
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {


    var visits =xmlhttp.responseText;

    var url = "www.blackhorse.co.uk";
    var chars = url.length+34;
    var todaydata = visits.substring(visits.split(url, 2).join(url).length+chars).substr(0, visits.substring(visits.split(url, 2).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 3).join(url).length+chars).substr(0, visits.substring(visits.split(url, 3).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 4).join(url).length+chars).substr(0, visits.substring(visits.split(url, 4).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 5).join(url).length+chars).substr(0, visits.substring(visits.split(url, 5).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 6).join(url).length+chars).substr(0, visits.substring(visits.split(url, 6).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 7).join(url).length+chars).substr(0, visits.substring(visits.split(url, 7).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 8).join(url).length+chars).substr(0, visits.substring(visits.split(url, 8).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 9).join(url).length+chars).substr(0, visits.substring(visits.split(url, 9).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 10).join(url).length+chars).substr(0, visits.substring(visits.split(url, 10).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 11).join(url).length+chars).substr(0, visits.substring(visits.split(url, 11).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 12).join(url).length+chars).substr(0, visits.substring(visits.split(url, 12).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 13).join(url).length+chars).substr(0, visits.substring(visits.split(url, 13).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 14).join(url).length+chars).substr(0, visits.substring(visits.split(url, 14).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 15).join(url).length+chars).substr(0, visits.substring(visits.split(url, 15).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 16).join(url).length+chars).substr(0, visits.substring(visits.split(url, 16).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 17).join(url).length+chars).substr(0, visits.substring(visits.split(url, 17).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 18).join(url).length+chars).substr(0, visits.substring(visits.split(url, 18).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 19).join(url).length+chars).substr(0, visits.substring(visits.split(url, 19).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 20).join(url).length+chars).substr(0, visits.substring(visits.split(url, 20).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 21).join(url).length+chars).substr(0, visits.substring(visits.split(url, 21).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 22).join(url).length+chars).substr(0, visits.substring(visits.split(url, 22).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 23).join(url).length+chars).substr(0, visits.substring(visits.split(url, 23).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 24).join(url).length+chars).substr(0, visits.substring(visits.split(url, 24).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 25).join(url).length+chars).substr(0, visits.substring(visits.split(url, 25).join(url).length+chars).indexOf('</td>'));

    var todaytotal = +visits.substring(visits.split(url, 2).join(url).length+chars).substr(0, visits.substring(visits.split(url, 2).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 3).join(url).length+chars).substr(0, visits.substring(visits.split(url, 3).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 4).join(url).length+chars).substr(0, visits.substring(visits.split(url, 4).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 5).join(url).length+chars).substr(0, visits.substring(visits.split(url, 5).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 6).join(url).length+chars).substr(0, visits.substring(visits.split(url, 6).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 7).join(url).length+chars).substr(0, visits.substring(visits.split(url, 7).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 8).join(url).length+chars).substr(0, visits.substring(visits.split(url, 8).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 9).join(url).length+chars).substr(0, visits.substring(visits.split(url, 9).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 10).join(url).length+chars).substr(0, visits.substring(visits.split(url, 10).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 11).join(url).length+chars).substr(0, visits.substring(visits.split(url, 11).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 12).join(url).length+chars).substr(0, visits.substring(visits.split(url, 12).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 13).join(url).length+chars).substr(0, visits.substring(visits.split(url, 13).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 14).join(url).length+chars).substr(0, visits.substring(visits.split(url, 14).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 15).join(url).length+chars).substr(0, visits.substring(visits.split(url, 15).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 16).join(url).length+chars).substr(0, visits.substring(visits.split(url, 16).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 17).join(url).length+chars).substr(0, visits.substring(visits.split(url, 17).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 18).join(url).length+chars).substr(0, visits.substring(visits.split(url, 18).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 19).join(url).length+chars).substr(0, visits.substring(visits.split(url, 19).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 20).join(url).length+chars).substr(0, visits.substring(visits.split(url, 20).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 21).join(url).length+chars).substr(0, visits.substring(visits.split(url, 21).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 22).join(url).length+chars).substr(0, visits.substring(visits.split(url, 22).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 23).join(url).length+chars).substr(0, visits.substring(visits.split(url, 23).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 24).join(url).length+chars).substr(0, visits.substring(visits.split(url, 24).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 25).join(url).length+chars).substr(0, visits.substring(visits.split(url, 25).join(url).length+chars).indexOf('</td>'));


    var url = "www.blackhorse.co.uk";
    var chars = url.length+34;
    var yesterdaydata = visits.substring(visits.split(url, 26).join(url).length+chars).substr(0, visits.substring(visits.split(url, 26).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 27).join(url).length+chars).substr(0, visits.substring(visits.split(url, 27).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 28).join(url).length+chars).substr(0, visits.substring(visits.split(url, 28).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 29).join(url).length+chars).substr(0, visits.substring(visits.split(url, 29).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 30).join(url).length+chars).substr(0, visits.substring(visits.split(url, 30).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 31).join(url).length+chars).substr(0, visits.substring(visits.split(url, 31).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 32).join(url).length+chars).substr(0, visits.substring(visits.split(url, 32).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 33).join(url).length+chars).substr(0, visits.substring(visits.split(url, 33).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 34).join(url).length+chars).substr(0, visits.substring(visits.split(url, 34).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 35).join(url).length+chars).substr(0, visits.substring(visits.split(url, 35).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 36).join(url).length+chars).substr(0, visits.substring(visits.split(url, 36).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 37).join(url).length+chars).substr(0, visits.substring(visits.split(url, 37).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 38).join(url).length+chars).substr(0, visits.substring(visits.split(url, 38).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 39).join(url).length+chars).substr(0, visits.substring(visits.split(url, 39).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 40).join(url).length+chars).substr(0, visits.substring(visits.split(url, 40).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 41).join(url).length+chars).substr(0, visits.substring(visits.split(url, 41).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 42).join(url).length+chars).substr(0, visits.substring(visits.split(url, 42).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 43).join(url).length+chars).substr(0, visits.substring(visits.split(url, 43).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 44).join(url).length+chars).substr(0, visits.substring(visits.split(url, 44).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 45).join(url).length+chars).substr(0, visits.substring(visits.split(url, 45).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 46).join(url).length+chars).substr(0, visits.substring(visits.split(url, 46).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 47).join(url).length+chars).substr(0, visits.substring(visits.split(url, 47).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 48).join(url).length+chars).substr(0, visits.substring(visits.split(url, 48).join(url).length+chars).indexOf('</td>'))+","+
                visits.substring(visits.split(url, 49).join(url).length+chars).substr(0, visits.substring(visits.split(url, 49).join(url).length+chars).indexOf('</td>'));

    var yesterdaytotal = +visits.substring(visits.split(url, 26).join(url).length+chars).substr(0, visits.substring(visits.split(url, 26).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 27).join(url).length+chars).substr(0, visits.substring(visits.split(url, 27).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 28).join(url).length+chars).substr(0, visits.substring(visits.split(url, 28).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 29).join(url).length+chars).substr(0, visits.substring(visits.split(url, 29).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 30).join(url).length+chars).substr(0, visits.substring(visits.split(url, 30).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 31).join(url).length+chars).substr(0, visits.substring(visits.split(url, 31).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 32).join(url).length+chars).substr(0, visits.substring(visits.split(url, 32).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 33).join(url).length+chars).substr(0, visits.substring(visits.split(url, 33).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 34).join(url).length+chars).substr(0, visits.substring(visits.split(url, 34).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 35).join(url).length+chars).substr(0, visits.substring(visits.split(url, 35).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 36).join(url).length+chars).substr(0, visits.substring(visits.split(url, 36).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 37).join(url).length+chars).substr(0, visits.substring(visits.split(url, 37).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 38).join(url).length+chars).substr(0, visits.substring(visits.split(url, 38).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 39).join(url).length+chars).substr(0, visits.substring(visits.split(url, 39).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 40).join(url).length+chars).substr(0, visits.substring(visits.split(url, 40).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 41).join(url).length+chars).substr(0, visits.substring(visits.split(url, 41).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 42).join(url).length+chars).substr(0, visits.substring(visits.split(url, 42).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 43).join(url).length+chars).substr(0, visits.substring(visits.split(url, 43).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 44).join(url).length+chars).substr(0, visits.substring(visits.split(url, 44).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 45).join(url).length+chars).substr(0, visits.substring(visits.split(url, 45).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 46).join(url).length+chars).substr(0, visits.substring(visits.split(url, 46).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 47).join(url).length+chars).substr(0, visits.substring(visits.split(url, 47).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 48).join(url).length+chars).substr(0, visits.substring(visits.split(url, 48).join(url).length+chars).indexOf('</td>'))+
                +visits.substring(visits.split(url, 49).join(url).length+chars).substr(0, visits.substring(visits.split(url, 49).join(url).length+chars).indexOf('</td>'));


    console.log(visits);  
    console.log("todaydata - "+todaydata);
    console.log("yesterdaydata - "+yesterdaydata);
 

    //document.getElementById("datatable").innerHTML = visits;



Highcharts.chart('container', {
    chart: {
        type: 'column'
    },
    title: {
        text: 'Visits to Blackhorse.co.uk',
        style: {
            fontWeight: 'bold',
            fontSize: '28px'
        }
    },
    subtitle: {
        //text: 'Source: WorldClimate.com'
    },
            legend: {
          borderRadius:0,
            backgroundColor: '#FFFFFF',
            itemMarginBottom: 7,
            layout: 'vertical',
            align: 'blahblah', //dunno why but removing this defaults it to top, crap value overlays it
            verticalAlign: 'top',                
            y: 130,
            x: 100,
            borderWidth: 0,
            width:210,
            symbolPadding: 10,
            useHTML:true,
            shadow: {
              color: '#000',
              width: 3,
              opacity: 0.15,
              offsetY: 2,
              offsetX: 1
            },
            labelFormatter: function() {
              return '<div class="' + this.name + '-arrow"></div><span style="font-family: \'Advent Pro\', sans-serif; font-size:20px">' + this.name +'</span><br/><span style="font-size:16px; color:#ababaa">(Total: ' + this.options.total + ')</span>';
        }

        },
    xAxis: {
        categories: ['12am','1am','2am','3am','4am','5am','6am','7am','8am','9am','10am','11am','12pm','1pm','2pm','3pm','4pm','5pm','6pm','7pm','8pm','9pm','10pm','11pm'],

        crosshair: true,
                labels: {
            style: {
                fontSize: '16px'
            }
        }
    },
    yAxis: {
        min: 0,
        title: {
            text: 'Visits',
            style: {
                fontWeight: 'bold',
                fontSize: '20px'
            }
        },
                labels: {
            style: {
                fontSize: '15px'
            }
        }
    },
    tooltip: {
        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            '<td style="padding:0"><b>{point.y:,.0f}</b></td></tr>',
        footerFormat: '</table>',
        shared: true,
        useHTML: true
    },
    plotOptions: {
        series: {
            animation: false
        }
    },



    series: [
    {
        name: 'Today',
        total: JSON.parse("[" + todaytotal.toLocaleString() + "]"), //toLocaleString adds a comma for 1000s
        data: JSON.parse("[" + todaydata + "]"),
    },
    {
        name: 'Yesterday',
        total: JSON.parse("[" + yesterdaytotal.toLocaleString() + "]"),
        data: JSON.parse("[" + yesterdaydata + "]"),
        color: '#af6767'
    }
    ]

});

 
    }
}


xmlhttp.send();
    setTimeout(function () {
    WTCall();
    }, 300000);
}




</script>


</html>