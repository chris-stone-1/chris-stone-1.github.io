<!DOCTYPE html>
<html>

<head>
<style>
table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 440px;
}

td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
}

tr:nth-child(even) {
    background-color: #dddddd;
}

</style>
</head>

<h2>Black Horse API Status</h2>

<p>API Services are checked every 5 minutes.</p>

<table>
  <tr>
    <th>Service</th>
    <th>Status</th>
    <th>Last Checked</th>
  </tr>
  <tr>
    <td id="name1"></td>
    <td id="error1"></td>
    <td id="lastcheck1"></td>
  </tr>
  <tr>
    <td id="name2"></td>
    <td id="error2"></td>
    <td id="lastcheck2"></td>
  </tr>
  <tr>
    <td id="name3"></td>
    <td id="error3"></td>
    <td id="lastcheck3"></td>
  </tr>
  <tr>
    <td id="name4"></td>
    <td id="error4"></td>
    <td id="lastcheck4"></td>
  </tr>
</table>



<body onload="upCall()">

<script>

function upCall() {

xmlhttp = new XMLHttpRequest();
var url = "https://api.uptrends.com/v3/probegroups/fa617a3b-f6c2-47cf-9081-74fa77d8ef47/status?format=json";
xmlhttp.open("GET", url, true);
xmlhttp.setRequestHeader("Content-type", "application/json");
xmlhttp.setRequestHeader("Authorization", "Basic Y2hyaXN0b3BoZXIuc3RvbmVAbGJnYXNzZXRmaW5hbmNlLmNvLnVrOmNocmlzMTVhd2Vzb21l"); 
xmlhttp.onreadystatechange = function () {
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

	var apiuptime = JSON.parse(xmlhttp.responseText);
	console.log(xmlhttp.responseText);

	var lastcheck1 = apiuptime[0].LastCheck.split('T').pop(); var error1 = apiuptime[0].ErrorLevel;
	var lastcheck2 = apiuptime[1].LastCheck.split('T').pop(); var error2 = apiuptime[1].ErrorLevel;
	var lastcheck3 = apiuptime[2].LastCheck.split('T').pop(); var error3 = apiuptime[2].ErrorLevel;
	var lastcheck4 = apiuptime[3].LastCheck.split('T').pop(); var error4 = apiuptime[3].ErrorLevel;

	if (error1 == "NoError") {error1 = "OK";} else { if (error1 == "InActive") {error1 = ""; lastcheck1 = "MONITOR OFF"} else {error1 = "DOWN";} }	
	if (error2 == "NoError") {error2 = "OK";} else { if (error2 == "InActive") {error2 = ""; lastcheck2 = "MONITOR OFF"} else {error2 = "DOWN";} }
	if (error3 == "NoError") {error3 = "OK";} else { if (error3 == "InActive") {error3 = ""; lastcheck3 = "MONITOR OFF"} else {error3 = "DOWN";} }
	if (error4 == "NoError") {error4 = "OK";} else { if (error4 == "InActive") {error4 = ""; lastcheck4 = "MONITOR OFF"} else {error4 = "DOWN";} }

	document.getElementById("error1").innerHTML = error1;
	document.getElementById("error2").innerHTML = error2;
	document.getElementById("error3").innerHTML = error3;
	document.getElementById("error4").innerHTML = error4;
	document.getElementById("lastcheck1").innerHTML = lastcheck1;
	document.getElementById("lastcheck2").innerHTML = lastcheck2;
	document.getElementById("lastcheck3").innerHTML = lastcheck3;
	document.getElementById("lastcheck4").innerHTML = lastcheck4;

  if (error1 == "DOWN") {
  xmlhttp = new XMLHttpRequest();
  xmlhttp.open("POST", "https://maker.ifttt.com/trigger/uptrends/with/key/cBW8X7ZxoSFbUBsByJ8gwy?value1=GFV is down");
  xmlhttp.send();
  }

  if (error2 == "DOWN") {
  xmlhttp = new XMLHttpRequest();
  xmlhttp.open("POST", "https://maker.ifttt.com/trigger/uptrends/with/key/cBW8X7ZxoSFbUBsByJ8gwy?value1=Post Customer is down");
  xmlhttp.send();
  }

  if (error2 == "DOWN") {
  xmlhttp = new XMLHttpRequest();
  xmlhttp.open("POST", "https://maker.ifttt.com/trigger/uptrends/with/key/cBW8X7ZxoSFbUBsByJ8gwy?value1=Settlement is down");
  xmlhttp.send();
  }


    }
}

	xmlhttp.send(JSON.stringify(parameters));

xmlhttp2 = new XMLHttpRequest();
var url = "https://api.uptrends.com/v3/probegroups/fa617a3b-f6c2-47cf-9081-74fa77d8ef47/members?format=json";
xmlhttp2.open("GET", url, true);
xmlhttp2.setRequestHeader("Content-type", "application/json");
xmlhttp2.setRequestHeader("Authorization", "Basic Y2hyaXN0b3BoZXIuc3RvbmVAbGJnYXNzZXRmaW5hbmNlLmNvLnVrOmNocmlzMTVhd2Vzb21l"); 
xmlhttp2.onreadystatechange = function () {
    if (xmlhttp2.readyState == 4 && xmlhttp2.status == 200) {

	var apiuptime = JSON.parse(xmlhttp2.responseText);
	console.log(xmlhttp2.responseText);

	document.getElementById("name1").innerHTML = apiuptime[0].Name;
	document.getElementById("name2").innerHTML = apiuptime[1].Name;
	document.getElementById("name3").innerHTML = apiuptime[2].Name;
	document.getElementById("name4").innerHTML = apiuptime[3].Name;

    }
}
	xmlhttp2.send(JSON.stringify(parameters));
    setTimeout(function () {
	upCall();
    }, 60000);



}





var parameters = {
//    "Name": "My new group"
};

</script>


</html>